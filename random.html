<html>
<head>
  
  <title>Script for random</title>

  <script src="http://code.jquery.com/jquery-1.10.2.min.js" type="text/javascript"></script>
  <script src="http://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true"></script>
  
  <script type="text/javascript">

    var map;
    var random;
    var distance;
    var myPosition;
    var position;
    var distance;
    var pos1;
    var pos2;

    var flagAreas = [

      [59.2967322, 18.0009393],
      [59.2980245, 17.9971503],
      [59.2981078, 17.9980875],
      [59.2982762, 17.9970823],
      [59.2987638, 17.9917639],
      [59.2987649, 17.9917824],
      [59.2987847, 17.9917731],
      [59.2988498, 17.991684],
      [59.2988503, 17.9981593],
      [59.3008233, 18.0041763],
      [59.3014033, 18.0068793],
      [59.3016619, 18.0137766]
    ];

    function initialize() {
        
        //here is the starting for the map, where it will begin to show
        var latlng = new google.maps.LatLng(59.2982762, 17.9970823);

        var myOptions = {
          zoom: 13,
          center: latlng,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };

          var map = new google.maps.Map(document.getElementById('map-canvas'), myOptions);

        //geolocation

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
            myPosition = new google.maps.LatLng(position.coords.latitude,
                                                position.coords.longitude);

                  //var pos1 = position.coords.latitude;
                  //var pos2 = position.coords.longitude;
                  //console.log(pos1 + ' and ' + pos2);

          var infowindow = new google.maps.InfoWindow({
            map: map,
            position: myPosition,
            content: "You are here"
          });
            
            map.setCenter(myPosition);
          },  function() {
            handleNoGeolocation(true);
          });
        }

          else {
          handleNoGeolocation(false);
        }

          function handleNoGeolocation(errorflag) {
          if (errorflag) {
            alert('Geolocation not supported');
            myPosition = latlng;
          }

          else {
            alert('Could not find your location');
            myPosition = latlng;
          };

          var infowindow = new google.maps.InfoWindow(options);
          map.setCenter(options, position);
        }

        //stop geolocation

        //start random markers/flags

          var random = flagAreas.sort(function() {
          return Math.random() - 0.5 })[0];

            var marker = new google.maps.Marker({
              position: new google.maps.LatLng(random[0], random[1]),
              map: map,
            });
        }

        window.onload = initialize;

        //code to calcute
 if (typeof(Number.prototype.toRad) === "undefined") {
    Number.prototype.toRad = function() {
    return this * Math.PI / 180;
  }

}
 
 function getDistance(lat1,lon1,lat2,lon2) {
 
    var lat1 = parseFloat(lat1);
    var lat2 = parseFloat(lat2);
    var lon1 = parseFloat(lon1);
    var lon2 = parseFloat(lon2);
    var R = 6371000; // meters
    var dLat = (lat2-lat1).toRad();
    var dLon = (lon2-lon1).toRad(); 
    var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
            Math.sin(dLon/2) * Math.sin(dLon/2); 
    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
    return R * c;
}
        
        var distance = getDistance(position.coords.latitude, position.coords.longitude, flagAreas[0], flagAreas[1]);
        console.log(distance);

    </script>

    <style type="text/css">

    #map-canvas {
      width: 700px;
      height: 900px;
      margin: 0 auto;
    }

    </style>

</head>
<body>

  <div id="map-canvas"></div>
    <div class="break">
    </div><!-- end break -->


</body>
</html>